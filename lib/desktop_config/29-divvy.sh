#!/usr/bin/env bash

plist="$HOME/Library/Preferences/com.mizage.direct.Divvy.plist"

/usr/libexec/PlistBuddy -c "Set :kXMRegCode $DIVVY_NAME" $plist
/usr/libexec/PlistBuddy -c "Set :kXMRegName $DIVVY_LIC" $plist


# Some sane defaults
/usr/libexec/PlistBuddy -c "Set :defaultColumnCount 10" $plist
/usr/libexec/PlistBuddy -c "Set :defaultRowCount 10" $plist

# Set hotkey to be cmd+shift+d
/usr/libexec/PlistBuddy -c "Set :globalHotkey:keyCode 2" $plist
/usr/libexec/PlistBuddy -c "Set :globalHotkey:modifiers 768" $plist

open "divvy://import/YnBsaXN0MDDUAQIDBAUImZpUJHRvcFgkb2JqZWN0c1gkdmVyc2lvblkkYXJjaGl2ZXLRBgdUcm9vdIABrxAcCQobMjM6QkNLTFRVXV5lZm1udnd+f4aHjY6UlVUkbnVsbNILDA0OViRjbGFzc1pOUy5vYmplY3RzgBusDxAREhMUFRYXGBkagAKABYAHgAmAC4ANgA+AEYATgBWAF4AZ3RwdHh8gISIjJCUmJwsoKSorKSksLS4tMCwxXxASc2VsZWN0aW9uRW5kQ29sdW1uXxARc2VsZWN0aW9uU3RhcnRSb3dca2V5Q29tYm9Db2RlV2VuYWJsZWRda2V5Q29tYm9GbGFnc18QFHNlbGVjdGlvblN0YXJ0Q29sdW1uW3NpemVDb2x1bW5zWnN1YmRpdmlkZWRXbmFtZUtleVZnbG9iYWxfEA9zZWxlY3Rpb25FbmRSb3dYc2l6ZVJvd3MQBBAAEA4JEAoIgAMIEAmABFFl0jQ1NjlYJGNsYXNzZXNaJGNsYXNzbmFtZaI3OFhTaG9ydGN1dFhOU09iamVjdFhTaG9ydGN1dN0cHR4fICEiIyQlJicLMCk7Kyk9LC0/LTAsMRAPCRAFCIAGCIAEUXLdHB0eHyAhIiMkJSYnC0QpRSspRSwtSC0wLDEQCBABCQiACAiABFFz3RwdHh8gISIjJCUmJwtNKU4rKSksLVEtMCwxEAYQEQkIgAoIgARRdN0cHR4fICEiIyQlJicLMClWKylYLC1aLTAsMRAQCRAHCIAMCIAEUXndHB0eHyAhIiMkJSYnCzApXyspKSwtYi0wLDEQAwkIgA4IgARRZt0cHR4fICEiIyQlJicLRSlnKykpRC1qLVhEMRASCQiAEAiABFEx3RwdHh8gISIjJCUmJwtfKW8rKXFELXMtWEQxEBMJEAIIgBIIgARRMt0cHR4fICEiIyQlJicLPSl4KykoRC17LVhEMRAUCQiAFAiABFEz3RwdHh8gISIjJCUmJwtYKYArKU1ELYMtWEQxEBUJCIAWCIAEUTTdHB0eHyAhIiMkJSYnC1gpKSspKUQtii1fRDEJCIAYCIAEUWHdHB0eHyAhIiMkJSYnC1goTSspKUQtkS1YRDEJCIAaCIAEUXrSNDWWl6OXmDheTlNNdXRhYmxlQXJyYXlXTlNBcnJheRIAAYagXxAPTlNLZXllZEFyY2hpdmVyAAgAEQAWAB8AKAAyADUAOgA8AFsAYQBmAG0AeAB6AIcAiQCLAI0AjwCRAJMAlQCXAJkAmwCdAJ8AugDPAOMA8AD4AQYBHQEpATQBPAFDAVUBXgFgAWIBZAFlAWcBaAFqAWsBbQFvAXEBdgF/AYoBjQGWAZ8BqAHDAcUBxgHIAckBywHMAc4B0AHrAe0B7wHwAfEB8wH0AfYB+AITAhUCFwIYAhkCGwIcAh4CIAI7Aj0CPgJAAkECQwJEAkYCSAJjAmUCZgJnAmkCagJsAm4CiQKLAowCjQKPApACkgKUAq8CsQKyArQCtQK3ArgCugK8AtcC2QLaAtsC3QLeAuAC4gL9Av8DAAMBAwMDBAMGAwgDIwMkAyUDJwMoAyoDLANHA0gDSQNLA0wDTgNQA1UDWQNoA3ADdQAAAAAAAAIBAAAAAAAAAJsAAAAAAAAAAAAAAAAAAAOH"
